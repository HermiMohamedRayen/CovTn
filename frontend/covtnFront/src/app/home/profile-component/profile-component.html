<div class="profile-container">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <button class="back-button" (click)="previousPage()">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <h1>Profile</h1>
      <div class="spacer"></div>
    </div>
  </div>

  <!-- Profile Content -->
  <div class="profile-content">
    <!-- Profile Header -->
    <div class="profile-header">
        <div class="avatar" *ngIf="noimg == -1"> 
          <i class="spinner"></i>
        </div>
      
      
     

      <div class="avatar" *ngIf="noimg == 0" (click)="updateimg()">
        <mat-icon>person</mat-icon>
      </div>
        <img [src]="imgUrl" alt="Profile Image" class="avatar" (click)="updateimg()" *ngIf="noimg == 1" />

    
      <h2>{{ user().firstName }} {{ user().lastName }}</h2>
      <p>{{ user().email }}</p>
      
      @if (apiService.hasRole("ROLE_DRIVER")){<div class="rating">
        <mat-icon class="rating-star">star</mat-icon>
        <span>{{ getAverageRating() }}</span>
      </div>}
    </div>

    <!-- Contact Info -->
    <div class="info-card">
      <h3>Contact Information</h3>
      <div class="contact-list">
        <div class="contact-item">
          <div class="icon-container">
            <mat-icon>phone</mat-icon>
          </div>
          <span (dblclick)="updatePhoneNumber()">{{ user().number || 'N/A' }}</span>
          <small>Double-click to update</small>
        </div>

        <div class="contact-item">
          <div class="icon-container">
            <mat-icon>email</mat-icon>
          </div>
          <span>{{ user().email }}</span>
        </div>
      </div>
    </div>

    <!-- Settings -->
    <div class="info-card">
      <h3>Settings</h3>

      <div class="setting-item" *ngIf="user().car" (click)="viewCar()">
        <div class="setting-info">
          <div class="icon-container">
            <mat-icon>directions_car</mat-icon>
          </div>
            <span>My car</span>
            
        </div>
       
      </div>
      <div class="setting-item" (click)="viewParticipations()">
        <div class="setting-info">
          <div class="icon-container">
            <mat-icon>event_seat</mat-icon>
          </div>
            <span>My Participations</span>
            
        </div>
       
      </div>
      <div class="setting-item" *ngIf="user().rides && user().rides.length > 0" routerLink="/my-rides">
        <div class="setting-info">
          <div class="icon-container">
            <mat-icon>navigation</mat-icon>
          </div>
            <span>My rides</span>
            
        </div>
       
      </div>


    </div>

    <!-- Logout Button -->
    <button mat-button class="logout-button" (click)="logout()">
      Logout
    </button>
  </div>
</div>